<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Observer (core.Core.Quickcheck_intf.Observer)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">core</a> &#x00BB; <a href="../../index.html">Core</a> &#x00BB; <a href="../index.html">Quickcheck_intf</a> &#x00BB; Observer</nav><header class="odoc-preamble"><h1>Module type <code><span>Quickcheck_intf.Observer</span></code></h1><p>An <code>'a Quickcheck.Observer.t</code> represents a hash function on <code>'a</code>. Observers are used to construct distributions of random functions; see <code>Quickcheck.Generator.fn</code>.</p><p>Like generators, observers have a <code>~size</code> argument that is threaded through to bound the depth of recursion in potentially infinite cases. For finite values, <code>size</code> can be ignored.</p><p>For hashable types, one can construct an observer using <code>of_hash</code>. For other types, use the built-in observers and observer combinators below, or use <code>create</code> directly.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>-'a t</span></span><span> = <span><span class="type-var">'a</span> <a href="../../../../base_quickcheck/Base_quickcheck/Observer/index.html#type-t">Base_quickcheck.Observer.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>size:<a href="../../../../base/Base/Int/index.html#type-t">Base.Int.t</a> <span class="arrow">&#45;&gt;</span></span> <span>hash:<a href="../../../../base/Base/Hash/index.html#type-state">Base.Hash.state</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Hash/index.html#type-state">Base.Hash.state</a> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-observe" class="anchored"><a href="#val-observe" class="anchor"></a><code><span><span class="keyword">val</span> observe : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span>size:<a href="../../../../base/Base/Int/index.html#type-t">Base.Int.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>hash:<a href="../../../../base/Base/Hash/index.html#type-state">Base.Hash.state</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../../base/Base/Hash/index.html#type-state">Base.Hash.state</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-of_hash" class="anchored"><a href="#val-of_hash" class="anchor"></a><code><span><span class="keyword">val</span> of_hash : <span><span>(<span class="keyword">module</span> <a href="../module-type-Deriving_hash/index.html">Deriving_hash</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-Deriving_hash/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_hash</code> creates an observer for any hashable type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bool" class="anchored"><a href="#val-bool" class="anchor"></a><code><span><span class="keyword">val</span> bool : <span><a href="../../../../base/Base/Bool/index.html#type-t">Base.Bool.t</a> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-char" class="anchored"><a href="#val-char" class="anchor"></a><code><span><span class="keyword">val</span> char : <span><a href="../../../../base/Base/Char/index.html#type-t">Base.Char.t</a> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-doubleton" class="anchored"><a href="#val-doubleton" class="anchor"></a><code><span><span class="keyword">val</span> doubleton : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Bool/index.html#type-t">Base.Bool.t</a> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>doubleton f</code> maps values to two &quot;buckets&quot; (as described in <code>t</code> above), depending on whether they satisfy <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-enum" class="anchored"><a href="#val-enum" class="anchor"></a><code><span><span class="keyword">val</span> enum : <span><a href="../../../../base/Base/Int/index.html#type-t">Base.Int.t</a> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Int/index.html#type-t">Base.Int.t</a> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>enum n ~f</code> maps values to <code>n</code> buckets, where <code>f</code> produces the index for a bucket from <code>0</code> to <code>n-1</code> for each value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_list" class="anchored"><a href="#val-of_list" class="anchor"></a><code><span><span class="keyword">val</span> of_list : <span><span><span class="type-var">'a</span> <a href="../../../../base/Base/List/index.html#type-t">Base.List.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>equal:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Bool/index.html#type-t">Base.Bool.t</a> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_list list ~equal</code> maps values in <code>list</code> to separate buckets, and compares observed values to the elements of <code>list</code> using <code>equal</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fixed_point" class="anchored"><a href="#val-fixed_point" class="anchor"></a><code><span><span class="keyword">val</span> fixed_point : <span><span>( <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Fixed point observer for recursive types. For example:</p><pre><code>let sexp_obs =
  fixed_point (fun sexp_t -&gt;
    unmap (variant2 string (list sexp_t))
      ~f:(function
        | Sexp.Atom atom -&gt; `A atom
        | Sexp.List list -&gt; `B list))</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-variant2" class="anchored"><a href="#val-variant2" class="anchor"></a><code><span><span class="keyword">val</span> variant2 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`A of <span class="type-var">'a</span></span> <span><span>| `B</span> of <span class="type-var">'b</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-variant3" class="anchored"><a href="#val-variant3" class="anchor"></a><code><span><span class="keyword">val</span> variant3 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`A of <span class="type-var">'a</span></span> <span><span>| `B</span> of <span class="type-var">'b</span></span> <span><span>| `C</span> of <span class="type-var">'c</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-variant4" class="anchored"><a href="#val-variant4" class="anchor"></a><code><span><span class="keyword">val</span> variant4 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`A of <span class="type-var">'a</span></span> <span><span>| `B</span> of <span class="type-var">'b</span></span> <span><span>| `C</span> of <span class="type-var">'c</span></span> <span><span>| `D</span> of <span class="type-var">'d</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-variant5" class="anchored"><a href="#val-variant5" class="anchor"></a><code><span><span class="keyword">val</span> variant5 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`A of <span class="type-var">'a</span></span> <span><span>| `B</span> of <span class="type-var">'b</span></span> <span><span>| `C</span> of <span class="type-var">'c</span></span> <span><span>| `D</span> of <span class="type-var">'d</span></span> <span><span>| `E</span> of <span class="type-var">'e</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-variant6" class="anchored"><a href="#val-variant6" class="anchor"></a><code><span><span class="keyword">val</span> variant6 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'f</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`A of <span class="type-var">'a</span></span> <span><span>| `B</span> of <span class="type-var">'b</span></span> <span><span>| `C</span> of <span class="type-var">'c</span></span> <span><span>| `D</span> of <span class="type-var">'d</span></span> <span><span>| `E</span> of <span class="type-var">'e</span></span> <span><span>| `F</span> of <span class="type-var">'f</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-of_predicate" class="anchored"><a href="#val-of_predicate" class="anchor"></a><code><span><span class="keyword">val</span> of_predicate : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Bool/index.html#type-t">Base.Bool.t</a> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_predicate t1 t2 ~f</code> combines <code>t1</code> and <code>t2</code>, where <code>t1</code> observes values that satisfy <code>f</code> and <code>t2</code> observes values that do not satisfy <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-comparison" class="anchored"><a href="#val-comparison" class="anchor"></a><code><span><span class="keyword">val</span> comparison : 
  <span>compare:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../base/Base/Int/index.html#type-t">Base.Int.t</a> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>eq:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span>lt:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>gt:<span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>comparison ~compare ~eq ~lt ~gt</code> combines observers <code>lt</code> and <code>gt</code>, where <code>lt</code> observes values less than <code>eq</code> according to <code>compare</code>, and <code>gt</code> observes values greater than <code>eq</code> according to <code>compare</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-singleton" class="anchored"><a href="#val-singleton" class="anchor"></a><code><span><span class="keyword">val</span> singleton : <span><a href="../../../../base/Base/Unit/index.html#type-t">Base.Unit.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">_</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>maps all values to a single bucket.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unmap" class="anchored"><a href="#val-unmap" class="anchor"></a><code><span><span class="keyword">val</span> unmap : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>unmap t ~f</code> applies <code>f</code> to values before observing them using <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tuple2" class="anchored"><a href="#val-tuple2" class="anchor"></a><code><span><span class="keyword">val</span> tuple2 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-tuple3" class="anchored"><a href="#val-tuple3" class="anchor"></a><code><span><span class="keyword">val</span> tuple3 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-tuple4" class="anchored"><a href="#val-tuple4" class="anchor"></a><code><span><span class="keyword">val</span> tuple4 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-tuple5" class="anchored"><a href="#val-tuple5" class="anchor"></a><code><span><span class="keyword">val</span> tuple5 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-tuple6" class="anchored"><a href="#val-tuple6" class="anchor"></a><code><span><span class="keyword">val</span> tuple6 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'f</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span> * <span class="type-var">'f</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-fn" class="anchored"><a href="#val-fn" class="anchor"></a><code><span><span class="keyword">val</span> fn : <span><span><span class="type-var">'a</span> <a href="../../../../base_quickcheck/Base_quickcheck/Generator/index.html#type-t">Base_quickcheck.Generator.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Observer for function type. <code>fn gen t</code> observes a function by generating random inputs from <code>gen</code>, applying the function, and observing the output using <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_fun" class="anchored"><a href="#val-of_fun" class="anchor"></a><code><span><span class="keyword">val</span> of_fun : <span><span>( <span><a href="../../../../base/Base/Unit/index.html#type-t">Base.Unit.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_fun f</code> produces an observer that lazily applies <code>f</code>.</p><p>It is recommended that <code>f</code> should not do a lot of expensive work and should not be memoized. Instead, spread out the work of generating an observer over many <code>of_fun</code> calls combined with, e.g., <code>variant</code> or <code>tuple</code>. This allows lazily generated observers to be garbage collected after each test and the relevant portions cheaply recomputed in subsequent tests, rather than accumulating without bound over time.</p></div></div></div></body></html>