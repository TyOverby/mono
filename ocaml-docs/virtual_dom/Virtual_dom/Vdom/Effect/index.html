<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Effect (virtual_dom.Virtual_dom.Vdom.Effect)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">virtual_dom</a> &#x00BB; <a href="../../index.html">Virtual_dom</a> &#x00BB; <a href="../index.html">Vdom</a> &#x00BB; Effect</nav><header class="odoc-preamble"><h1>Module <code><span>Vdom.Effect</span></code></h1></header><div class="odoc-content"><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="../../../Ui_effect/index.html">Ui_effect</a> <span class="keyword">end</span></span></code></summary><div class="odoc-include"><div class="odoc-spec"><div class="spec module-type" id="module-type-Handler" class="anchored"><a href="#module-type-Handler" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> Handler</span><span> = <a href="../../../Ui_effect/module-type-Handler/index.html">Ui_effect.Handler</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = <span><span class="type-var">'a</span> <a href="../../../Ui_effect/index.html#type-t">Ui_effect.t</a></span></span><span> = </span><span>..</span></code></div><div class="spec-doc"><p><code>'a Effect.t</code> represents some computation of type <code>'a</code> that can be performed outside of the typical computational/incremental structure of a Bonsai program . Examples of this computation might be:</p><ul><li>Calling an RPC and getting the result back</li><li>Running expensive computation on a web-worker thread</li><li>Requesting some information from the imperative &quot;Start.Handle&quot;-holding code</li></ul><p>If you have a value of type <code>'a Effect.t</code>, you can schedule it to be run by calling <code>inject</code> and providing a function that will be called when the callback completes.</p></div></div><div class="odoc-spec"><div class="spec type extension" id="extension-decl-Ignore" class="anchored"><a href="#extension-decl-Ignore" class="anchor"></a><code><span><span class="keyword">type</span> <a href="#type-t">t</a> += </span></code><table><tr id="extension-Ignore" class="anchored"><td class="def extension"><a href="#extension-Ignore" class="anchor"></a><code><span>| </span><span><span class="extension">Ignore</span> : <span>unit <a href="#type-t">t</a></span></span></code></td></tr><tr id="extension-Many" class="anchored"><td class="def extension"><a href="#extension-Many" class="anchor"></a><code><span>| </span><span><span class="extension">Many</span> : <span><span>unit <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span> <span>unit <a href="#type-t">t</a></span></span></code></td></tr></table></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../base/Base/Monad/module-type-S/index.html">Core.Monad.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="../../../../base/Base/Monad/module-type-S/index.html#type-t">t</a></span> := <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></span></code></summary><div class="odoc-include"><div class="odoc-include"><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;=)" class="anchored"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;=) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t &gt;&gt;= f</code> returns a computation that sequences the computations represented by two monad elements. The resulting computation first does <code>t</code> to yield a value <code>v</code>, and then runs the computation returned by <code>f v</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;|)" class="anchored"><a href="#val-(&gt;&gt;|)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;|) : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t &gt;&gt;| f</code> is <code>t &gt;&gt;= (fun a -&gt; return (f a))</code>.</p></div></div></div><div class="odoc-spec"><div class="spec module" id="module-Monad_infix" class="anchored"><a href="#module-Monad_infix" class="anchor"></a><code><span><span class="keyword">module</span> Monad_infix</span><span> = <a href="../../../Ui_effect/Monad_infix/index.html">Ui_effect.Monad_infix</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bind t ~f</code> = <code>t &gt;&gt;= f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>return v</code> returns the (trivial) computation that returns v.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map t ~f</code> is t &gt;&gt;| f.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-join" class="anchored"><a href="#val-join" class="anchor"></a><code><span><span class="keyword">val</span> join : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>join t</code> is <code>t &gt;&gt;= (fun t' -&gt; t')</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ignore_m" class="anchored"><a href="#val-ignore_m" class="anchor"></a><code><span><span class="keyword">val</span> ignore_m : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>ignore_m t</code> is <code>map t ~f:(fun _ -&gt; ())</code>. <code>ignore_m</code> used to be called <code>ignore</code>, but we decided that was a bad name, because it shadowed the widely used <code>Caml.ignore</code>. Some monads still do <code>let ignore = ignore_m</code> for historical reasons.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-all" class="anchored"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-all_unit" class="anchored"><a href="#val-all_unit" class="anchor"></a><code><span><span class="keyword">val</span> all_unit : <span><span><span>unit <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Like <code>all</code>, but ensures that every monadic value in the list produces a unit value, all of which are discarded rather than being collected into a list.</p></div></div></div><div class="odoc-include"><div class="odoc-spec"><div class="spec module" id="module-Let_syntax" class="anchored"><a href="#module-Let_syntax" class="anchor"></a><code><span><span class="keyword">module</span> Let_syntax</span><span> = <a href="../../../Ui_effect/Let_syntax/index.html">Ui_effect.Let_syntax</a></span></code></div></div></div></details></div><div class="odoc-spec"><div class="spec value" id="val-never" class="anchored"><a href="#val-never" class="anchor"></a><code><span><span class="keyword">val</span> never : <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>An effect that never completes</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lazy_" class="anchored"><a href="#val-lazy_" class="anchor"></a><code><span><span class="keyword">val</span> lazy_ : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <a href="../../../../core/Core/Lazy/index.html#type-t">Core.Lazy.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>If creating an effect could be expensive, you can wrap its construction in a lazy and pass it to this function so that its construction will be deferred until it's about to be evaluated.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-print_s" class="anchored"><a href="#val-print_s" class="anchor"></a><code><span><span class="keyword">val</span> print_s : <span><a href="../../../../core/Core/Sexp/index.html#type-t">Core.Sexp.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Prints the sexp when scheduled.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_sync_fun" class="anchored"><a href="#val-of_sync_fun" class="anchor"></a><code><span><span class="keyword">val</span> of_sync_fun : <span><span>( <span><span class="type-var">'query</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'result</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'query</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'result</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_sync_fun</code> is similar to <code>of_deferred_fun</code> but with a synchronous function instead of a deferred one. This can be used for functions that are synchronous but side-effecting, or as a mock-function in tests that replace the usages of <code>of_deferred_fun</code> in the actual app.</p><p>Note that, unlike <code>of_deferred_fun</code>, the function must return immediately, so it's not possible to test the behaviour of tour app between calling the function and the effect becoming 'determined'. If you need to do this, see <code>of_svar</code> and <code>of_query_response_tracker</code> below.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Define" class="anchored"><a href="#module-Define" class="anchor"></a><code><span><span class="keyword">module</span> Define</span><span> = <a href="../../../Ui_effect/Define/index.html">Ui_effect.Define</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Define1" class="anchored"><a href="#module-Define1" class="anchor"></a><code><span><span class="keyword">module</span> Define1</span><span> = <a href="../../../Ui_effect/Define1/index.html">Ui_effect.Define1</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Private" class="anchored"><a href="#module-Private" class="anchor"></a><code><span><span class="keyword">module</span> Private</span><span> = <a href="../../../Ui_effect/Private/index.html">Ui_effect.Private</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-For_testing" class="anchored"><a href="#module-For_testing" class="anchor"></a><code><span><span class="keyword">module</span> For_testing</span><span> = <a href="../../../Ui_effect/For_testing/index.html">Ui_effect.For_testing</a></span></code></div></div></div></details></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Visibility_handler" class="anchored"><a href="#module-type-Visibility_handler" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Visibility_handler/index.html">Visibility_handler</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-S" class="anchored"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type extension" id="extension-decl-Viewport_changed" class="anchored"><a href="#extension-decl-Viewport_changed" class="anchor"></a><code><span><span class="keyword">type</span> <a href="#type-t">t</a> += </span></code><table><tr id="extension-Viewport_changed" class="anchored"><td class="def extension"><a href="#extension-Viewport_changed" class="anchor"></a><code><span>| </span><span><span class="extension">Viewport_changed</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>Viewport_changed</code> events are delivered to all visibility handlers</p><span class="comment-delim">*)</span></td></tr><tr id="extension-Stop_propagation" class="anchored"><td class="def extension"><a href="#extension-Stop_propagation" class="anchor"></a><code><span>| </span><span><span class="extension">Stop_propagation</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>Stop_propagation</code> prevents the underlying DOM event from propagating up to the parent elements</p><span class="comment-delim">*)</span></td></tr><tr id="extension-Stop_immediate_propagation" class="anchored"><td class="def extension"><a href="#extension-Stop_immediate_propagation" class="anchor"></a><code><span>| </span><span><span class="extension">Stop_immediate_propagation</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>Stop_immediate_propagation</code> causes <code>sequence_as_sibling</code> to ignore next sequenced event.</p><span class="comment-delim">*)</span></td></tr><tr id="extension-Prevent_default" class="anchored"><td class="def extension"><a href="#extension-Prevent_default" class="anchor"></a><code><span>| </span><span><span class="extension">Prevent_default</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>Prevent_default</code> prevents the default browser action from occurring as a result of this event</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-sequence_as_sibling" class="anchored"><a href="#val-sequence_as_sibling" class="anchor"></a><code><span><span class="keyword">val</span> sequence_as_sibling : <span><span>unit <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unless_stopped:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Sequences two events, but only if the first is neither <code>Stop_immediate_propagation</code> nor a <code>Many</code> which contains <code>Stop_immediate_propagation</code>. Use this instead of <code>Many</code> if combining events that are associated with the same source; for example, the motivation for this function is for merging Inputs of hooks.</p><p>The second argument is a function that takes unit not because it is expected to be impure, but because often it is computed via some arbitrary handler function. Using hooks as an example, often the input to a hook has type <code>'a -&gt; Effect.t</code>. To merge inputs <code>f</code> and <code>g</code>, you might write</p><pre><code>fun x -&gt; sequence_as_sibling (f x) (g x)</code></pre><p>but this might unnecessarily call <code>g</code> if <code>f</code> returns something with <code>Stop_immediate_propagation</code>. Instead, using this API, you must write</p><pre><code>fun x -&gt; sequence_as_sibling (f x) (fun () -&gt; (g x))</code></pre></div></div><div class="odoc-spec"><div class="spec module" id="module-Define_visibility" class="anchored"><a href="#module-Define_visibility" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Define_visibility/index.html">Define_visibility</a></span><span> (<a href="Define_visibility/argument-1-VH/index.html">VH</a> : <a href="module-type-Visibility_handler/index.html">Visibility_handler</a>) : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>For registering a handler for Viewport_changed events. Note that if this functor is called multiple times, each handler will see all of the events.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Expert" class="anchored"><a href="#module-Expert" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Expert/index.html">Expert</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>