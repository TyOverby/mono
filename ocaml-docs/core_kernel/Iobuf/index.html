<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Iobuf (core_kernel.Iobuf)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">core_kernel</a> &#x00BB; Iobuf</nav><header class="odoc-preamble"><h1>Module <code><span>Iobuf</span></code></h1><p>A non-moving (in the GC sense) contiguous range of bytes, useful for I/O operations.</p><p>An iobuf consists of:</p><ul><li>bigstring</li><li>limits -- a subrange of the bigstring</li><li>window -- a subrange of the limits</li></ul><p>All iobuf operations are restricted to operate within the limits. Initially, the window of an iobuf is identical to its limits. A phantom type, the &quot;seek&quot; permission, controls whether or not code is allowed to change the limits and window. With seek permission, the limits can be <code>narrow</code>ed, but can never be widened, and the window can be set to an arbitrary subrange of the limits.</p><p>A phantom type controls whether code can read and write bytes in the bigstring (within the limits) or can only read them.</p><p>To present a restricted view of an iobuf to a client, one can create a sub-iobuf or add a type constraint.</p><p>Functions operate on the window unless the documentation or naming indicates otherwise.</p></header><nav class="odoc-toc"><ul><li><a href="#creation">Creation</a></li><li><a href="#accessors">Accessors</a></li><li><a href="#changing-the-limits">Changing the limits</a></li><li><a href="#comparison">Comparison</a></li><li><a href="#changing-the-window">Changing the window</a></li><li><a href="#getting-and-setting-data">Getting and setting data</a></li><li><a href="#expert">Expert</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-seek" class="anchored"><a href="#type-seek" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> seek</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_seek" class="anchored"><a href="#val-sexp_of_seek" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_seek : <span><a href="#type-seek">seek</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-no_seek" class="anchored"><a href="#type-no_seek" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> no_seek</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_no_seek" class="anchored"><a href="#val-sexp_of_no_seek" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_no_seek : <span><a href="#type-no_seek">no_seek</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t_repr" class="anchored"><a href="#type-t_repr" class="anchor"></a><code><span><span class="keyword">type</span> t_repr</span></code></div><div class="spec-doc"><p>This type is a compiler witness that 'rw and 'seek do not affect layout; it enables wider use of unboxed GADTs.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>(-'data_perm_read_write, +'seek_permission) t</span></span><span> = <span class="keyword">private</span> <a href="#type-t_repr">t_repr</a></span></code></div><div class="spec-doc"><p>The first type parameter controls whether the iobuf can be written to. The second type parameter controls whether the window and limits can be changed.</p><p>See the <code>Perms</code> module for information on how the first type parameter is used.</p><p>To allow <code>no_seek</code> or <code>seek</code> access, a function's type uses <code>_</code> rather than <code>no_seek</code> as the type argument to <code>t</code>. Using <code>_</code> allows the function to be directly applied to either permission. Using a specific permission would require code to use coercion <code>:&gt;</code>.</p><p>There is no <code>t_of_sexp</code>. One should use <code>Iobuf.Hexdump.t_of_sexp</code> or <code>@sexp.opaque</code> as desired.</p></div></div><div class="odoc-spec"><div class="spec type subst" id="type-iobuf" class="anchored"><a href="#type-iobuf" class="anchor"></a><code><span><span class="keyword">type</span> <span>('rw, 'seek) iobuf</span></span><span> := <span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t_with_shallow_sexp" class="anchored"><a href="#type-t_with_shallow_sexp" class="anchor"></a><code><span><span class="keyword">type</span> <span>('rw, 'seek) t_with_shallow_sexp</span></span><span> = <span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>t_with_shallow_sexp</code> has a <code>sexp_of</code> that shows the windows and limits of the underlying bigstring, but no data. We do this rather than deriving sexp_of on <code>t</code> because it is much more likely to be noise than useful information, and so callers should probably not display the iobuf at all.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_t_with_shallow_sexp" class="anchored"><a href="#val-sexp_of_t_with_shallow_sexp" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t_with_shallow_sexp : 
  <span><span>( <span><span class="type-var">'rw</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="type-var">'seek</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t_with_shallow_sexp">t_with_shallow_sexp</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../base/Base/Invariant/module-type-S2/index.html">Core.Invariant.S2</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>('rw, 'seek) <a href="../../base/Base/Invariant/module-type-S2/index.html#type-t">t</a></span> := <span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t">t</a></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-invariant" class="anchored"><a href="#val-invariant" class="anchor"></a><code><span><span class="keyword">val</span> invariant : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'b</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></details></div><div class="odoc-spec"><div class="spec module" id="module-Window" class="anchored"><a href="#module-Window" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Window/index.html">Window</a></span><span> : <a href="../../core/Core/Hexdump_intf/module-type-S2/index.html">Core.Hexdump.S2</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>('rw, 'seek) <a href="../../core/Core/Hexdump_intf/module-type-S2/index.html#type-t">t</a></span> := <span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t">t</a></span></span></span></code></div><div class="spec-doc"><p>Provides a <code>Window.Hexdump</code> submodule that renders the contents of <code>t</code>'s window.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Limits" class="anchored"><a href="#module-Limits" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Limits/index.html">Limits</a></span><span> : <a href="../../core/Core/Hexdump_intf/module-type-S2/index.html">Core.Hexdump.S2</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>('rw, 'seek) <a href="../../core/Core/Hexdump_intf/module-type-S2/index.html#type-t">t</a></span> := <span><span>( <span class="type-var">'rw</span>, <span class="type-var">'seek</span> )</span> <a href="#type-t">t</a></span></span></span></code></div><div class="spec-doc"><p>Provides a <code>Limits.Hexdump</code> submodule that renders the contents of <code>t</code>'s limits.</p></div></div><div class="odoc-include"><div class="spec-doc"><p>Provides a <code>Hexdump</code> submodule that renders the contents of <code>t</code>'s window and limits using indices relative to the limits.</p></div><div class="odoc-spec"><div class="spec module" id="module-Hexdump" class="anchored"><a href="#module-Hexdump" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Hexdump/index.html">Hexdump</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div><div class="odoc-spec"><div class="spec module" id="module-Debug" class="anchored"><a href="#module-Debug" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Debug/index.html">Debug</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Provides a <code>Debug.Hexdump</code> submodule that renders the contents of <code>t</code>'s window, limits, and underlying bigstring using indices relative to the bigstring.</p></div></div><h3 id="creation"><a href="#creation" class="anchor"></a>Creation</h3><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>len:int <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>create ~len</code> creates a new iobuf, backed by a bigstring of length <code>len</code>, with the limits and window set to the entire bigstring.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-empty" class="anchored"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <span><span>( <a href="../../core/Core/index.html#type-read">Core.read</a>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>empty</code> is an immutable <code>t</code> of size 0.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_bigstring" class="anchored"><a href="#val-of_bigstring" class="anchor"></a><code><span><span class="keyword">val</span> of_bigstring : 
  <span>?pos:int <span class="arrow">&#45;&gt;</span></span>
  <span>?len:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../core/Core/Bigstring/index.html#type-t">Core.Bigstring.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span>[&lt; <a href="../../core/Core/index.html#type-read_write">Core.read_write</a> ]</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_bigstring bigstring ~pos ~len</code> returns an iobuf backed by <code>bigstring</code>, with the window and limits specified starting at <code>pos</code> and of length <code>len</code>.</p><p>forbid <code>immutable</code> to prevent aliasing</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_string" class="anchored"><a href="#val-of_string" class="anchor"></a><code><span><span class="keyword">val</span> of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_string s</code> returns a new iobuf whose contents are <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sub_shared" class="anchored"><a href="#val-sub_shared" class="anchor"></a><code><span><span class="keyword">val</span> sub_shared : <span>?pos:int <span class="arrow">&#45;&gt;</span></span> <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">'d</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'d</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>sub_shared t ~pos ~len</code> returns a new iobuf with limits and window set to the subrange of <code>t</code>'s window specified by <code>pos</code> and <code>len</code>. <code>sub_shared</code> preserves data permissions, but allows arbitrary seek permissions on the resulting iobuf.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-copy" class="anchored"><a href="#val-copy" class="anchor"></a><code><span><span class="keyword">val</span> copy : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>copy t</code> returns a new iobuf whose contents are the same as those in the window of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-clone" class="anchored"><a href="#val-clone" class="anchor"></a><code><span><span class="keyword">val</span> clone : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>clone t</code> returns a new iobuf that is a deep-copy of <code>t</code> including an exact copy of the underlying buffer and bounds. This means data outside the window is copied as well.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transfer" class="anchored"><a href="#val-transfer" class="anchor"></a><code><span><span class="keyword">val</span> transfer : 
  <span>src:<span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-read">Core.read</a> ]</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>dst:<span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-write">Core.write</a> ]</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>transfer ~src ~dst</code> makes the window of <code>dst</code> into a copy of the window of <code>src</code>. Like <code>blito</code>, <code>transfer</code> will raise if <code>Iobuf.length dst</code> &lt; <code>Iobuf.length src</code>.</p><p>It is a utility function defined as <code>reset dst; blito ~src ~dst; flip_lo dst</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_bounds_and_buffer" class="anchored"><a href="#val-set_bounds_and_buffer" class="anchor"></a><code><span><span class="keyword">val</span> set_bounds_and_buffer : 
  <span>src:<span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-write">Core.write</a> ]</span> <span class="keyword">as</span> 'data, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>dst:<span><span>( <span class="type-var">'data</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>set_bounds_and_buffer ~src ~dst</code> copies bounds metadata (i.e., limits and window) and shallowly copies the buffer (data pointer) from <code>src</code> to <code>dst</code>. It does not access data, but does allow access through <code>dst</code>. This makes <code>dst</code> an alias of <code>src</code>.</p><p>Because <code>set_bounds_and_buffer</code> creates an alias, we disallow immutable <code>src</code> and <code>dst</code> using <code>[&gt; write]</code>. Otherwise, one of <code>src</code> or <code>dst</code> could be <code>read_write :&gt;
    read</code> and the other <code>immutable :&gt; read</code>, which would allow you to write the <code>immutable</code> alias's data through the <code>read_write</code> alias.</p><p><code>set_bounds_and_buffer</code> is typically used with a frame iobuf that need only be allocated once. This frame can be updated repeatedly and handed to users, without further allocation. Allocation-sensitive applications need this.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_bounds_and_buffer_sub" class="anchored"><a href="#val-set_bounds_and_buffer_sub" class="anchor"></a><code><span><span class="keyword">val</span> set_bounds_and_buffer_sub : 
  <span>pos:int <span class="arrow">&#45;&gt;</span></span>
  <span>len:int <span class="arrow">&#45;&gt;</span></span>
  <span>src:<span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-write">Core.write</a> ]</span> <span class="keyword">as</span> 'data, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>dst:<span><span>( <span class="type-var">'data</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>set_bounds_and_buffer_sub ~pos ~len ~src ~dst</code> is a more efficient version of <code>set_bounds_and_buffer ~src:(Iobuf.sub_shared ~pos ~len src) ~dst</code>.</p><p><code>set_bounds_and_buffer ~src ~dst</code> is not the same as <code>set_bounds_and_buffer_sub ~dst
    ~src ~len:(Iobuf.length src)</code> because the limits are narrowed in the latter case.</p><p><code>~len</code> and <code>~pos</code> are mandatory for performance reasons, in concert with <code>@@inline</code>. If they were optional, allocation would be necessary when passing a non-default, non-constant value, which is an important use case.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_only" class="anchored"><a href="#val-read_only" class="anchor"></a><code><span><span class="keyword">val</span> read_only : <span><span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-read">Core.read</a> ]</span>, <span class="type-var">'s</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="../../core/Core/index.html#type-read">Core.read</a>, <span class="type-var">'s</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Generalization</p><p>One may wonder why you'd want to call <code>no_seek</code>, given that a cast is already possible, e.g., <code>t : (_, seek) t :&gt; (_, no_seek) t</code>. It turns out that if you want to define some <code>f : (_, _) t -&gt; unit</code> of your own that can be conveniently applied to <code>seek</code> iobufs without the user having to cast <code>seek</code> up, you need this <code>no_seek</code> function.</p><p><code>read_only</code> is more of a historical convenience now that <code>read_write</code> is a polymorphic variant, as one can now explicitly specify the general type for an argument with something like <code>t : (_ perms, _) t :&gt; (read, _) t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-no_seek" class="anchored"><a href="#val-no_seek" class="anchor"></a><code><span><span class="keyword">val</span> no_seek : <span><span><span>( <span class="type-var">'r</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'r</span>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span></span></code></div></div><h3 id="accessors"><a href="#accessors" class="anchor"></a>Accessors</h3><div class="odoc-spec"><div class="spec value" id="val-capacity" class="anchored"><a href="#val-capacity" class="anchor"></a><code><span><span class="keyword">val</span> capacity : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>capacity t</code> returns the size of <code>t</code>'s limits subrange. The capacity of an iobuf can be reduced via <code>narrow</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length" class="anchored"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>length t</code> returns the size of <code>t</code>'s window.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length_lo" class="anchored"><a href="#val-length_lo" class="anchor"></a><code><span><span class="keyword">val</span> length_lo : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>length_lo t</code> returns the length that <code>t</code>'s window would have after calling <code>flip_lo</code>, without actually changing the window. This is the number of bytes between the lower limit and the start of the window.</p><p>When you're writing to the window, you can think of this as the number of bytes already written. When reading from the window, this can mean the number of bytes already consumed.</p><p>This is equivalent to: </p><pre><code>Iobuf.Expert.(lo t - lo_min t)</code></pre><p>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length_hi" class="anchored"><a href="#val-length_hi" class="anchor"></a><code><span><span class="keyword">val</span> length_hi : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>length_hi t</code> returns the length that <code>t</code>'s window would have after calling <code>flip_hi</code>, without actually changing the window. This is the number of bytes between the end of the window and the upper limit of the buffer.</p><p>This is equivalent to: </p><pre><code>Iobuf.Expert.(hi_max t - hi t) </code></pre><p>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-is_empty" class="anchored"><a href="#val-is_empty" class="anchor"></a><code><span><span class="keyword">val</span> is_empty : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_empty t</code> is <code>length t = 0</code>.</p></div></div><h3 id="changing-the-limits"><a href="#changing-the-limits" class="anchor"></a>Changing the limits</h3><div class="odoc-spec"><div class="spec value" id="val-narrow" class="anchored"><a href="#val-narrow" class="anchor"></a><code><span><span class="keyword">val</span> narrow : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>narrow t</code> sets <code>t</code>'s limits to the current window.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-narrow_lo" class="anchored"><a href="#val-narrow_lo" class="anchor"></a><code><span><span class="keyword">val</span> narrow_lo : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>narrow_lo t</code> sets <code>t</code>'s lower limit to the beginning of the current window.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-narrow_hi" class="anchored"><a href="#val-narrow_hi" class="anchor"></a><code><span><span class="keyword">val</span> narrow_hi : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>narrow_hi t</code> sets <code>t</code>'s upper limit to the end of the current window.</p></div></div><h3 id="comparison"><a href="#comparison" class="anchor"></a>Comparison</h3><div class="odoc-spec"><div class="spec value" id="val-memcmp" class="anchored"><a href="#val-memcmp" class="anchor"></a><code><span><span class="keyword">val</span> memcmp : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>memcmp a b</code> first compares the length of <code>a</code> and <code>b</code>'s windows and then compares the bytes in the windows for equivalence.</p></div></div><h3 id="changing-the-window"><a href="#changing-the-window" class="anchor"></a>Changing the window</h3><p>One can call <code>Lo_bound.window t</code> to get a snapshot of the lower bound of the window, and then later restore that snapshot with <code>Lo_bound.restore</code>. This is useful for speculatively parsing, and then rewinding when there isn't enough data to finish.</p><p>Similarly for <code>Hi_bound.window</code> and <code>Lo_bound.restore</code>.</p><p>Using a snapshot with a different iobuf, even a sub iobuf of the snapshotted one, has unspecified results. An exception may be raised, or a silent error may occur. However, the safety guarantees of the iobuf will not be violated, i.e., the attempt will not enlarge the limits of the subject iobuf.</p><div class="odoc-spec"><div class="spec module-type" id="module-type-Bound" class="anchored"><a href="#module-type-Bound" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Bound/index.html">Bound</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Lo_bound" class="anchored"><a href="#module-Lo_bound" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lo_bound/index.html">Lo_bound</a></span><span> : <a href="module-type-Bound/index.html">Bound</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Hi_bound" class="anchored"><a href="#module-Hi_bound" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Hi_bound/index.html">Hi_bound</a></span><span> : <a href="module-type-Bound/index.html">Bound</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-advance" class="anchored"><a href="#val-advance" class="anchor"></a><code><span><span class="keyword">val</span> advance : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>advance t amount</code> advances the lower bound of the window by <code>amount</code>. It is an error to advance past the upper bound of the window or the lower limit.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unsafe_advance" class="anchored"><a href="#val-unsafe_advance" class="anchor"></a><code><span><span class="keyword">val</span> unsafe_advance : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>unsafe_advance</code> is like <code>advance</code> but with no bounds checking, so incorrect usage can easily cause segfaults.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-resize" class="anchored"><a href="#val-resize" class="anchor"></a><code><span><span class="keyword">val</span> resize : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>len:int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>resize t</code> sets the length of <code>t</code>'s window, provided it does not exceed limits.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unsafe_resize" class="anchored"><a href="#val-unsafe_resize" class="anchor"></a><code><span><span class="keyword">val</span> unsafe_resize : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>len:int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>unsafe_resize</code> is like <code>resize</code> but with no bounds checking, so incorrect usage can easily cause segfaults.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-rewind" class="anchored"><a href="#val-rewind" class="anchor"></a><code><span><span class="keyword">val</span> rewind : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>rewind t</code> sets the lower bound of the window to the lower limit.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-reset" class="anchored"><a href="#val-reset" class="anchor"></a><code><span><span class="keyword">val</span> reset : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>reset t</code> sets the window to the limits.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-flip_lo" class="anchored"><a href="#val-flip_lo" class="anchor"></a><code><span><span class="keyword">val</span> flip_lo : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>flip_lo t</code> sets the window to range from the lower limit to the lower bound of the old window. This is typically called after a series of <code>Fill</code>s, to reposition the window in preparation to <code>Consume</code> the newly written data.</p><p>The bounded version narrows the effective limit. This can preserve some data near the limit, such as a hypothetical packet header (in the case of <code>bounded_flip_lo</code>) or unfilled suffix of a buffer (in <code>bounded_flip_hi</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bounded_flip_lo" class="anchored"><a href="#val-bounded_flip_lo" class="anchor"></a><code><span><span class="keyword">val</span> bounded_flip_lo : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Lo_bound/index.html#type-t">Lo_bound.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compact" class="anchored"><a href="#val-compact" class="anchor"></a><code><span><span class="keyword">val</span> compact : <span><span><span>( <a href="../../core/Core/index.html#type-read_write">Core.read_write</a>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>compact t</code> copies data from the window to the lower limit of the iobuf and sets the window to range from the end of the copied data to the upper limit. This is typically called after a series of <code>Consume</code>s to save unread data and prepare for the next series of <code>Fill</code>s and <code>flip_lo</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bounded_compact" class="anchored"><a href="#val-bounded_compact" class="anchor"></a><code><span><span class="keyword">val</span> bounded_compact : 
  <span><span><span>( <a href="../../core/Core/index.html#type-read_write">Core.read_write</a>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Lo_bound/index.html#type-t">Lo_bound.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Hi_bound/index.html#type-t">Hi_bound.t</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-flip_hi" class="anchored"><a href="#val-flip_hi" class="anchor"></a><code><span><span class="keyword">val</span> flip_hi : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>flip_hi t</code> sets the window to range from the the upper bound of the current window to the upper limit. This operation is dual to <code>flip_lo</code> and is typically called when the data in the current (narrowed) window has been processed and the window needs to be positioned over the remaining data in the buffer. For example:</p><pre><code>(* ... determine initial_data_len ... *)
Iobuf.resize buf ~len:initial_data_len;
(* ... and process initial data ... *)
Iobuf.flip_hi buf;</code></pre><p>Now the window of <code>buf</code> ranges over the remainder of the data.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bounded_flip_hi" class="anchored"><a href="#val-bounded_flip_hi" class="anchor"></a><code><span><span class="keyword">val</span> bounded_flip_hi : <span><span><span>( <span class="type-var">_</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="Hi_bound/index.html#type-t">Hi_bound.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-protect_window_and_bounds" class="anchored"><a href="#val-protect_window_and_bounds" class="anchor"></a><code><span><span class="keyword">val</span> protect_window_and_bounds : 
  <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>( <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>protect_window_and_bounds t ~f</code> calls <code>f t</code> with <code>t</code>'s bounds set to its current window, and restores <code>t</code>'s window, bounds, and buffer afterward.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-protect_window_and_bounds_1" class="anchored"><a href="#val-protect_window_and_bounds_1" class="anchor"></a><code><span><span class="keyword">val</span> protect_window_and_bounds_1 : 
  <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>( <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>protect_window_and_bounds_1 t x ~f</code> is a more efficient version of <code>protect_window_and_bounds t ~f:(fun t -&gt; f t x)</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-protect_window_and_bounds_2" class="anchored"><a href="#val-protect_window_and_bounds_2" class="anchor"></a><code><span><span class="keyword">val</span> protect_window_and_bounds_2 : 
  <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>( <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'c</span></span></code></div><div class="spec-doc"><p><code>protect_window_and_bounds_2 t x y ~f</code> is a more efficient version of <code>protect_window_and_bounds t ~f:(fun t -&gt; f t x y)</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-protect_window_and_bounds_3" class="anchored"><a href="#val-protect_window_and_bounds_3" class="anchor"></a><code><span><span class="keyword">val</span> protect_window_and_bounds_3 : 
  <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-no_seek">no_seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>( <span><span><span>( <span class="type-var">'rw</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'d</span></span></code></div><div class="spec-doc"><p><code>protect_window_and_bounds_3 t x y z ~f</code> is a more efficient version of <code>protect_window_and_bounds t ~f:(fun t -&gt; f t x y z)</code>.</p></div></div><h3 id="getting-and-setting-data"><a href="#getting-and-setting-data" class="anchor"></a>Getting and setting data</h3><p>&quot;consume&quot; and &quot;fill&quot; functions access data at the lower bound of the window and advance the lower bound of the window. &quot;peek&quot; and &quot;poke&quot; functions access data but do not advance the window.</p><div class="odoc-spec"><div class="spec value" id="val-to_string" class="anchored"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-read">Core.read</a> ]</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>to_string t</code> returns the bytes in <code>t</code> as a string. It does not alter the window.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_string_hum" class="anchored"><a href="#val-to_string_hum" class="anchor"></a><code><span><span class="keyword">val</span> to_string_hum : <span>?max_lines:int <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Equivalent to <code>Hexdump.to_string_hum</code>. Renders <code>t</code>'s windows and limits.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_bytes" class="anchored"><a href="#val-to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> to_bytes : <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../../core/Core/Bytes/index.html#type-t">Core.Bytes.t</a></span></code></div><div class="spec-doc"><p><code>to_bytes t</code> returns the bytes in <code>t</code> as a bytes. It does not alter the window.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_bytes" class="anchored"><a href="#val-of_bytes" class="anchor"></a><code><span><span class="keyword">val</span> of_bytes : <span><a href="../../core/Core/Bytes/index.html#type-t">Core.Bytes.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_bytes b</code> returns a new iobuf whose contents is <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Consume" class="anchored"><a href="#module-Consume" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Consume/index.html">Consume</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Consume.string t ~len</code> reads <code>len</code> characters (all, by default) from <code>t</code> into a new string and advances the lower bound of the window accordingly.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Fill" class="anchored"><a href="#module-Fill" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Fill/index.html">Fill</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Fill.bin_prot X.bin_write_t t x</code> writes <code>x</code> to <code>t</code> in bin-prot form, advancing past the bytes written.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Peek" class="anchored"><a href="#module-Peek" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Peek/index.html">Peek</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Peek</code> and <code>Poke</code> functions access a value at <code>pos</code> from the lower bound of the window and do not advance.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Poke" class="anchored"><a href="#module-Poke" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Poke/index.html">Poke</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Poke.bin_prot X.bin_write_t t x</code> writes <code>x</code> to the beginning of <code>t</code> in binary form without advancing. You can use <code>X.bin_size_t</code> to tell how long it was. <code>X.bin_write_t</code> is only allowed to write that portion of the buffer you have access to.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Unsafe" class="anchored"><a href="#module-Unsafe" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Unsafe/index.html">Unsafe</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Unsafe</code> has submodules that are like their corresponding module, except with no range checks. Hence, mistaken uses can cause segfaults. Be careful!</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_prot_length_prefix_bytes" class="anchored"><a href="#val-bin_prot_length_prefix_bytes" class="anchor"></a><code><span><span class="keyword">val</span> bin_prot_length_prefix_bytes : int</span></code></div><div class="spec-doc"><p>The number of bytes in the length prefix of <code>consume_bin_prot</code> and <code>fill_bin_prot</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fill_bin_prot" class="anchored"><a href="#val-fill_bin_prot" class="anchor"></a><code><span><span class="keyword">val</span> fill_bin_prot : 
  <span><span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-write">Core.write</a> ]</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../bin_prot/Bin_prot/Type_class/index.html#type-writer">Bin_prot.Type_class.writer</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="../../core/Core/Or_error/index.html#type-t">Core.Or_error.t</a></span></span></code></div><div class="spec-doc"><p><code>fill_bin_prot</code> writes a bin-prot value to the lower bound of the window, prefixed by its length, and advances by the amount written. <code>fill_bin_prot</code> returns an error if the window is too small to write the value.</p><p><code>consume_bin_prot t reader</code> reads a bin-prot value from the lower bound of the window, which should have been written using <code>fill_bin_prot</code>, and advances the window by the amount read. <code>consume_bin_prot</code> returns an error if there is not a complete message in the window and in that case the window is left unchanged.</p><p>Don't use these without a good reason, as they are incompatible with similar functions in <code>Reader</code> and <code>Writer</code>. They use a 4-byte length rather than an 8-byte length.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-consume_bin_prot" class="anchored"><a href="#val-consume_bin_prot" class="anchor"></a><code><span><span class="keyword">val</span> consume_bin_prot : 
  <span><span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-read">Core.read</a> ]</span>, <a href="#type-seek">seek</a> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../bin_prot/Bin_prot/Type_class/index.html#type-reader">Bin_prot.Type_class.reader</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../core/Core/Or_error/index.html#type-t">Core.Or_error.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Blit" class="anchored"><a href="#module-Blit" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Blit/index.html">Blit</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Blit</code> copies between iobufs and advances neither <code>src</code> nor <code>dst</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Blit_consume" class="anchored"><a href="#module-Blit_consume" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Blit_consume/index.html">Blit_consume</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Blit_consume</code> copies between iobufs and advances <code>src</code> but does not advance <code>dst</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Blit_fill" class="anchored"><a href="#module-Blit_fill" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Blit_fill/index.html">Blit_fill</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Blit_fill</code> copies between iobufs and advances <code>dst</code> but does not advance <code>src</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Blit_consume_and_fill" class="anchored"><a href="#module-Blit_consume_and_fill" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Blit_consume_and_fill/index.html">Blit_consume_and_fill</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Blit_consume_and_fill</code> copies between iobufs and advances both <code>src</code> and <code>dst</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-memset" class="anchored"><a href="#val-memset" class="anchor"></a><code><span><span class="keyword">val</span> memset : <span><span><span>( <a href="../../core/Core/index.html#type-read_write">Core.read_write</a>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>pos:int <span class="arrow">&#45;&gt;</span></span> <span>len:int <span class="arrow">&#45;&gt;</span></span> <span>char <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>memset t ~pos ~len c</code> fills <code>t</code> with <code>c</code> within the range <code>[pos, pos + len)</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-zero" class="anchored"><a href="#val-zero" class="anchor"></a><code><span><span class="keyword">val</span> zero : <span><span><span>( <a href="../../core/Core/index.html#type-read_write">Core.read_write</a>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>memset</code>s a buffer to zero.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-concat" class="anchored"><a href="#val-concat" class="anchor"></a><code><span><span class="keyword">val</span> concat : <span><span><span><span>( <span>[&gt; <a href="../../core/Core/index.html#type-read">Core.read</a> ]</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> array</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Create a new iobuf whose contents are the appended contents of the passed array.</p></div></div><h3 id="expert"><a href="#expert" class="anchor"></a>Expert</h3><div class="odoc-spec"><div class="spec module" id="module-Expert" class="anchored"><a href="#module-Expert" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Expert/index.html">Expert</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Expert</code> module is for building efficient out-of-module <code>Iobuf</code> abstractions.</p></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Accessors_common" class="anchored"><a href="#module-type-Accessors_common" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Accessors_common/index.html">Accessors_common</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>('d, 'w) Iobuf.t</code> accessor function manipulating <code>'a</code>, either writing it to the iobuf or reading it from the iobuf.</p></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Accessors_read" class="anchored"><a href="#module-type-Accessors_read" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Accessors_read/index.html">Accessors_read</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Accessors_write" class="anchored"><a href="#module-type-Accessors_write" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Accessors_write/index.html">Accessors_write</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Consuming_blit" class="anchored"><a href="#module-type-Consuming_blit" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Consuming_blit/index.html">Consuming_blit</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-consuming_blito" class="anchored"><a href="#type-consuming_blito" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> <span>('src, 'dst) consuming_blito</span></span><span> =
  <span>src:<span class="type-var">'src</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?src_len:int <span class="arrow">&#45;&gt;</span></span>
  <span>dst:<span class="type-var">'dst</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?dst_pos:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div></div></body></html>