<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bonsai (bonsai.Bonsai)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">bonsai</a> &#x00BB; Bonsai</nav><header class="odoc-preamble"><h1>Module <code><span>Bonsai</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module-substitution" id="module-Private_computation" class="anchored"><a href="#module-Private_computation" class="anchor"></a><code><span><span class="keyword">module</span> Private_computation := <a href="Computation/index.html">Computation</a></span></code></div></div><div class="odoc-spec"><div class="spec module-substitution" id="module-Private_value" class="anchored"><a href="#module-Private_value" class="anchor"></a><code><span><span class="keyword">module</span> Private_value := <a href="Value/index.html">Value</a></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Model" class="anchored"><a href="#module-type-Model" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Model/index.html">Model</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Action" class="anchored"><a href="#module-type-Action" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Action/index.html">Action</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Enum" class="anchored"><a href="#module-type-Enum" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Enum/index.html">Enum</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Comparator" class="anchored"><a href="#module-type-Comparator" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Comparator/index.html">Comparator</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-comparator" class="anchored"><a href="#type-comparator" class="anchor"></a><code><span><span class="keyword">type</span> <span>('k, 'cmp) comparator</span></span><span> =
  <span>(<span class="keyword">module</span> <span class="xref-unresolved">Bonsai__Module_types.Comparator</span>
  <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">comparator_witness</span> = <span class="type-var">'cmp</span>
   <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">t</span> = <span class="type-var">'k</span>)</span></span></code></div></div><p>The functions found in this module are focused on the manipulation of values of type <code>'a Computation.t</code> and <code>'a Value.t</code>. There are fine descriptions of these types below and how to use them, but since it's so common to convert between the two, here is a cheat-sheet matrix for converting between values of different types:</p><pre>    | Have \ Want      | 'a Value.t             | 'a Computation.t |
    |------------------+------------------------+------------------|
    | 'a               | let v = Value.return a | let c = const a  |
    | 'a Value.t       |                        | let c = read v   |
    | 'a Computation.t | let%sub v = c          |                  |</pre><div class="odoc-spec"><div class="spec module" id="module-Value" class="anchored"><a href="#module-Value" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Value/index.html">Value</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Computation" class="anchored"><a href="#module-Computation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Computation/index.html">Computation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Effect" class="anchored"><a href="#module-Effect" class="anchor"></a><code><span><span class="keyword">module</span> Effect</span><span> = <a href="../../virtual_dom/Ui_effect/index.html">Ui_effect</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Var" class="anchored"><a href="#module-Var" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Var/index.html">Var</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-read" class="anchored"><a href="#val-read" class="anchor"></a><code><span><span class="keyword">val</span> read : <span><span><span class="type-var">'a</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Converts a <code>Value.t</code> to a <code>Computation.t</code>. Unlike most Computations, the <code>Computation.t</code> returned by <code>read</code> can be used in multiple locations without maintaining multiple copies of any models or building duplicate incremental graphs.</p><p><code>read</code> is most commonly used in the final expression of a <code>let%sub</code> chain, like so:</p><pre><code>fun i -&gt;
  let%sub a = f i in
  let%sub b = g i in
  read
    (let%map a = a
     and b = b in
     a + b)</code></pre><p>or to use some APIs that require <code>Computation.t</code> like so:</p><pre><code>val cond : bool Value.t
val x : 'a Value.t
val some_computation : 'a Computation.t

let y = if_ cond ~then_:some_computation ~else_:(read x)
val y : 'a Computation.t</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-const" class="anchored"><a href="#val-const" class="anchor"></a><code><span><span class="keyword">val</span> const : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Creates a <code>Computation.t</code> that provides a constant value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-path_id" class="anchored"><a href="#val-path_id" class="anchor"></a><code><span><span class="keyword">val</span> path_id : <span>string <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Retrieves the path to the current computation as a string. This string is not human-readable, but can be used as an ID which is unique to this particular instance of a component.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pure" class="anchored"><a href="#val-pure" class="anchor"></a><code><span><span class="keyword">val</span> pure : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Lifts a regular OCaml function into one that takes a Value as input, and produces a Computation as output.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_module0" class="anchored"><a href="#val-of_module0" class="anchor"></a><code><span><span class="keyword">val</span> of_module0 : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Bonsai__Import.Component_s</span>
    <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">Action.t</span> = <span class="type-var">'a</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Input.t</span> = unit
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Model.t</span> = <span class="type-var">'m</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Result.t</span> = <span class="type-var">'r</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'m</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'r</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Given a first-class module that has no input (unit input type), and the default value of the state machine, <code>of_module0</code> will create a <code>Computation</code> that produces values of that module's <code>Result.t</code> type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_module1" class="anchored"><a href="#val-of_module1" class="anchor"></a><code><span><span class="keyword">val</span> of_module1 : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Bonsai__Import.Component_s</span>
    <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">Action.t</span> = <span class="type-var">'a</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Input.t</span> = <span class="type-var">'i</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Model.t</span> = <span class="type-var">'m</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Result.t</span> = <span class="type-var">'r</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'m</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'i</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'r</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>The same as <a href="#val-of_module0"><code>of_module0</code></a>, but this one has an input type <code>'i</code>. Because input to the component is required, this function also expects a <code>Value.t</code> that provides its input. It is common for this function to be partially applied like so:</p><pre><code>val a : int Value.t
val b : int Value.t

let f = of_module1 (module struct ... end) ~default_model in
let%sub a = f a in
let%sub b = f b in
...</code></pre><p>Where the <code>Value.t</code> values are passed in later.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_module2" class="anchored"><a href="#val-of_module2" class="anchor"></a><code><span><span class="keyword">val</span> of_module2 : 
  <span><span>(<span class="keyword">module</span> <span class="xref-unresolved">Bonsai__Import.Component_s</span>
    <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">Action.t</span> = <span class="type-var">'a</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Input.t</span> = <span class="type-var">'i1</span> * <span class="type-var">'i2</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Model.t</span> = <span class="type-var">'m</span>
     <span class="keyword">and</span> <span class="keyword">type</span> <span class="xref-unresolved">Result.t</span> = <span class="type-var">'r</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'m</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'i1</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'i2</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'r</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>The same as <a href="#val-of_module1"><code>of_module1</code></a> but with two inputs.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-state_machine0" class="anchored"><a href="#val-state_machine0" class="anchor"></a><code><span><span class="keyword">val</span> state_machine0 : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Action/index.html">Action</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Action/index.html#type-t">t</a> = <span class="type-var">'action</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span>apply_action:
    <span>( <span>inject:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
      <span>schedule_event:<span>( <span><span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'model</span> * <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>A constructor for <code>Computation.t</code> that models a simple state machine. The first-class module implementing <code>Model</code> describes the states in the state machine, while the first-class module implementing <code>Action</code> describes the transitions between states.</p><p><code>default_model</code> is the initial state for the state machine, and <code>apply_action</code> implements the transition function that looks at the current state and the requested transition, and produces a new state.</p><p>(It is very common for <code>inject</code> and <code>schedule_event</code> to be unused)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-actor0" class="anchored"><a href="#val-actor0" class="anchor"></a><code><span><span class="keyword">val</span> actor0 : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Action/index.html">Action</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Action/index.html#type-t">t</a> = <span class="type-var">'action</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span>recv:
    <span>( <span>schedule_event:<span>( <span><span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'model</span> * <span class="type-var">'return</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'model</span> * <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'return</span> <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Identical to <code>actor1</code> but it takes 0 inputs instead of 1.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-actor1" class="anchored"><a href="#val-actor1" class="anchor"></a><code><span><span class="keyword">val</span> actor1 : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Action/index.html">Action</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Action/index.html#type-t">t</a> = <span class="type-var">'action</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span>recv:
    <span>( <span>schedule_event:<span>( <span><span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'input</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'model</span> * <span class="type-var">'return</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'input</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'model</span> * <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'return</span> <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p><code>actor1</code> is very similar to <code>state_machine1</code>, with two major exceptions:</p><ul><li>the <code>apply-action</code> function for state-machine is renamed <code>recv</code>, and it returns a &quot;response&quot;, in addition to a new model.</li><li>the 2nd value returned by the component allows for the sender of an action to handle the effect and read the response.</li></ul><p>Because the semantics of this function feel like an actor system, we've decided to name the function accordingly.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-state" class="anchored"><a href="#val-state" class="anchor"></a><code><span><span class="keyword">val</span> state : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'model</span> * <span>( <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>A frequently used state-machine is the trivial 'set-state' transition, where the action always replaces the value contained inside. This helper-function implements that state-machine, providing access to the current state, as well as an inject function that updates the state.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-state_opt" class="anchored"><a href="#val-state_opt" class="anchor"></a><code><span><span class="keyword">val</span> state_opt : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="type-var">'model</span> option</span> * <span>( <span><span><span class="type-var">'model</span> option</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Similar to <code>state</code>, but stores an option of the model instead. <code>default_model</code> is optional and defaults to <code>None</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-state_machine1" class="anchored"><a href="#val-state_machine1" class="anchor"></a><code><span><span class="keyword">val</span> state_machine1 : 
  <span><a href="../../core/Core/Source_code_position/index.html#type-t">Core.Source_code_position.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="keyword">module</span> <a href="module-type-Action/index.html">Action</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Action/index.html#type-t">t</a> = <span class="type-var">'action</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span>apply_action:
    <span>( <span>inject:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
      <span>schedule_event:<span>( <span><span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'input</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'input</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'model</span> * <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>The same as <a href="#val-state_machine0"><code>state_machine0</code></a>, but <code>apply_action</code> also takes an input from a <code>Value.t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lazy_" class="anchored"><a href="#val-lazy_" class="anchor"></a><code><span><span class="keyword">val</span> lazy_ : <span><span><span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span> <a href="../../core/Core/Lazy/index.html#type-t">Core.Lazy.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p>Because all Bonsai computation-returning-functions are eagerly evaluated, attempting to use &quot;let rec&quot; to construct a recursive component will recurse infinitely. One way to avoid this is to use a lazy computation and <code>Bonsai.lazy_</code> to defer evaluating the <code>Computation.t</code>.</p><pre><code>let rec some_component arg1 arg2 =
  ...
  let _ = Bonsai.lazy_ (lazy (some_component ...)) in
  ...</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-assoc" class="anchored"><a href="#val-assoc" class="anchor"></a><code><span><span class="keyword">val</span> assoc : 
  <span><span><span>( <span class="type-var">'key</span>, <span class="type-var">'cmp</span> )</span> <a href="#type-comparator">comparator</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>( <span class="type-var">'key</span>, <span class="type-var">'data</span>, <span class="type-var">'cmp</span> )</span> <a href="../../core/Core/Map/index.html#type-t">Core.Map.t</a></span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:<span>( <span><span><span class="type-var">'key</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'data</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'result</span> <a href="Computation/index.html#type-t">Computation.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'key</span>, <span class="type-var">'result</span>, <span class="type-var">'cmp</span> )</span> <a href="../../core/Core/Map/index.html#type-t">Core.Map.t</a></span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p><code>assoc</code> is used to apply a Bonsai computation to each element of a map. This function signature is very similar to <code>Map.mapi</code> or <code>Incr_map.mapi'</code>, and for good reason!</p><p>It is doing the same thing (taking a map and a function and returning a new map with the function applied to every key-value pair), but this function does it with the Bonsai values, which means that the computation is done incrementally and also maintains a state machine for every key-value pair.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-enum" class="anchored"><a href="#val-enum" class="anchor"></a><code><span><span class="keyword">val</span> enum : 
  <span><span>(<span class="keyword">module</span> <a href="module-type-Enum/index.html">Enum</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Enum/index.html#type-t">t</a> = <span class="type-var">'k</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>match_:<span><span class="type-var">'k</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>with_:<span>( <span><span class="type-var">'k</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p><code>enum</code> is used for matching on a value and providing different behaviors on different values. The type of the value must be enumerable (there must be a finite number of possible values), and it must be comparable and sexpable.</p><p>The rest of the parameters are named like you might expect from pattern-matching syntax, with <code>match_</code> taking the value to match on, and <code>with_</code> taking a function that choose which behavior to use.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wrap" class="anchored"><a href="#val-wrap" class="anchor"></a><code><span><span class="keyword">val</span> wrap : 
  <span><span>(<span class="keyword">module</span> <a href="module-type-Model/index.html">Model</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Model/index.html#type-t">t</a> = <span class="type-var">'model</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>default_model:<span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span>apply_action:
    <span>( <span>inject:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
      <span>schedule_event:<span>( <span><span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'result</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
      <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>f:
    <span>( <span><span><span class="type-var">'model</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
      <span><span><span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span> )</span> <a href="Value/index.html#type-t">Value.t</a></span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'result</span> <a href="Computation/index.html#type-t">Computation.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'result</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p><code>wrap</code> wraps a Computation (built using <code>f</code>) and provides a model and injection function that the wrapped component can use. Especially of note is that the <code>apply_action</code> for this outer-model has access to the result value of the Computation being wrapped.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_model_resetter" class="anchored"><a href="#val-with_model_resetter" class="anchor"></a><code><span><span class="keyword">val</span> with_model_resetter : 
  <span><span><span class="type-var">'a</span> <a href="Computation/index.html#type-t">Computation.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span>unit <a href="../../virtual_dom/Ui_effect/index.html#type-t">Effect.t</a></span>)</span> <a href="Computation/index.html#type-t">Computation.t</a></span></span></code></div><div class="spec-doc"><p><code>with_model_resetter</code> extends a computation with the ability to reset the state machine for that computation back to its default. This can be useful for e.g. clearing a form of all input values.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Clock" class="anchored"><a href="#module-Clock" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Clock/index.html">Clock</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Functions allowing for the creation of time-dependent computations in a testable way.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Edge" class="anchored"><a href="#module-Edge" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Edge/index.html">Edge</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>All the functions in this module incorporate the concept of &quot;edge-triggering&quot;, which is the terminology that we use to describe actions that occur when a value changes.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Dynamic_scope" class="anchored"><a href="#module-Dynamic_scope" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Dynamic_scope/index.html">Dynamic_scope</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>This module implements dynamic variable scoping. Once a dynamic variable is created, you can store values in it, and lookup those same values. A lookup will find the nearest-most grandparent <code>set_within</code> call.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Incr" class="anchored"><a href="#module-Incr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Incr/index.html">Incr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Let_syntax" class="anchored"><a href="#module-Let_syntax" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Let_syntax/index.html">Let_syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>This <code>Let_syntax</code> module is basically just <code>Value</code>.Let_syntax with the addition of the <code>sub</code> function, which operates on Computations.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Debug" class="anchored"><a href="#module-Debug" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Debug/index.html">Debug</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Private" class="anchored"><a href="#module-Private" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Private/index.html">Private</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Arrow_deprecated" class="anchored"><a href="#module-Arrow_deprecated" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Arrow_deprecated/index.html">Arrow_deprecated</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>