<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>With_caching (incr_map.Incr_map_collate.Make.With_caching)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">incr_map</a> &#x00BB; <a href="../../index.html">Incr_map_collate</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; With_caching</nav><header class="odoc-preamble"><h1>Module <code><span>Make.With_caching</span></code></h1><p>A version of <code>collate</code> with caching.</p><p>We use <code>Incr_memoize</code> to cache incremental nodes for the result of a particular:</p><ul><li><code>order</code>,</li><li><code>(order, filter)</code>, and</li><li><code>(order, filter, range_bucket)</code></li></ul><p>so that even if the <code>Collate.t Incr.t</code> changes, as long as it changes back before the result is evicted from the cache, we can resume a cached incremental computation instead of discarding it and computing it from scratch.</p><p>Note that if an earlier incremental node is evicted from its cache, its children in subsequent caches are no longer used. This is to ensure we don't duplicate computations from building later nodes on top of semantically identical but physically distinct earlier nodes.</p><p>For example, if the <code>order</code> cache is LRU with size 2, and <code>order_filter_range</code> is LRU with size 10, you could get 10 cached final values if they only use two distinct orderings, but if they were to each have a distinct ordering, only two will be usable.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Range_memoize_bucket" class="anchored"><a href="#module-Range_memoize_bucket" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Range_memoize_bucket/index.html">Range_memoize_bucket</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-collate__sort_first" class="anchored"><a href="#val-collate__sort_first" class="anchor"></a><code><span><span class="keyword">val</span> collate__sort_first : 
  <span>filter_equal:<span>( <span><span class="type-var">'filter</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'filter</span> <span class="arrow">&#45;&gt;</span></span> bool )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>order_equal:<span>( <span><span class="type-var">'order</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'order</span> <span class="arrow">&#45;&gt;</span></span> bool )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>filter_to_predicate:<span>( <span><span class="type-var">'filter</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span>key:<span class="type-var">'k</span> <span class="arrow">&#45;&gt;</span></span> <span>data:<span class="type-var">'v</span> <span class="arrow">&#45;&gt;</span></span> bool )</span> option</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>order_to_compare:<span>( <span><span class="type-var">'order</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span> )</span> <a href="../../Compare/index.html#type-t">Compare.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>( <span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span> )</span> <a href="../../../../core/Core/Map/index.html#type-t">Core.Map.t</a></span> <a href="../argument-1-Incr/index.html#type-t">Incr.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>( <span class="type-var">'k</span>, <span class="type-var">'filter</span>, <span class="type-var">'order</span> )</span> <a href="../../Collate/index.html#type-t">Collate.t</a></span> <a href="../argument-1-Incr/index.html#type-t">Incr.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'k</span>, <span class="type-var">'v</span> )</span> <a href="../../Collated/index.html#type-t">Collated.t</a></span> <a href="../argument-1-Incr/index.html#type-t">Incr.t</a></span></span></code></div></div></div></body></html>