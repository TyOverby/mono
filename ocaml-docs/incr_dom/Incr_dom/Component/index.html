<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Component (incr_dom.Incr_dom.Component)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">incr_dom</a> &#x00BB; <a href="../index.html">Incr_dom</a> &#x00BB; Component</nav><header class="odoc-preamble"><h1>Module <code><span>Incr_dom.Component</span></code></h1><p>A <code>Component</code> captures the basic operations that need to be provided in order to build an Incr_dom app. The same type can be used both at the top-level of an app, as well as for defining individual components within a larger app.</p><p>The <a href="#type-t"><code>Component.t</code></a> is often constructed incrementally, and is always created incrementally at the top-level, as is required by <a href="../App_intf/module-type-S/index.html"><code>App_intf.S</code></a>.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-with_extra" class="anchored"><a href="#type-with_extra" class="anchor"></a><code><span><span class="keyword">type</span> <span>('action, 'model, 'state, 'extra) with_extra</span></span></code></div><div class="spec-doc"><p>The with_extra type allows the component to expose extra information that might be useful to the user of the component. This allows the module in which the component is defined to expose functions that can be used to query incrementally computed information about the the component.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('action, 'model, 'state) t</span></span><span> = <span><span>( <span class="type-var">'action</span>, <span class="type-var">'model</span>, <span class="type-var">'state</span>, unit )</span> <a href="#type-with_extra">with_extra</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-apply_action" class="anchored"><a href="#val-apply_action" class="anchor"></a><code><span><span class="keyword">val</span> apply_action : 
  <span><span><span>( <span class="type-var">'action</span>, <span class="type-var">'model</span>, <span class="type-var">'state</span>, <span class="type-var">_</span> )</span> <a href="#type-with_extra">with_extra</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span>
  <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'model</span></span></code></div><div class="spec-doc"><p><code>apply_action</code> is called to update the model in response to the arrival of a scheduled action. The function may have side effects, which among other things can trigger more actions.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-update_visibility" class="anchored"><a href="#val-update_visibility" class="anchor"></a><code><span><span class="keyword">val</span> update_visibility : 
  <span><span><span>( <span class="type-var">'action</span>, <span class="type-var">'model</span>, <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-with_extra">with_extra</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'model</span></span></code></div><div class="spec-doc"><p><code>update_visibility</code> is called in order to allow the component to query the state of the DOM to determine what is currently in view, and put that information into the model. This in turn allows for the rendering to limit the set of DOM nodes actually created to those that are in sight.</p><p><a href="../Start_app/index.html"><code>Start_app</code></a> calls <code>update_visibility</code> when a top-level resize or scroll is detected. Also, individual components that create scrollable widgets should create DOM event handlers that return the <code>Viewport_changed</code> event from <a href="../../../virtual_dom/Virtual_dom/Vdom/Effect/index.html"><code>Virtual_dom.Vdom.Effect</code></a> when those widgets are scrolled or resized. Otherwise, visibility changes may not be correctly captured.</p><p>Note that changes in visibility could trigger changes to the DOM that in turn cause the page to reflow. This can cause more changes in visibility, which can lead to an infinite loop. Such behavior is a bug in the component, but the framework doesn't attempt to stop cascading sequences of <code>update_visibility</code>, so that these bugs are not hidden.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-view" class="anchored"><a href="#val-view" class="anchor"></a><code><span><span class="keyword">val</span> view : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span>, <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-with_extra">with_extra</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../../../virtual_dom/Virtual_dom/Vdom/Node/index.html#type-t">Virtual_dom.Vdom.Node.t</a></span></code></div><div class="spec-doc"><p><code>view</code> is called to obtain the virtual DOM which is then applied to the actual DOM.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-extra" class="anchored"><a href="#val-extra" class="anchor"></a><code><span><span class="keyword">val</span> extra : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span>, <span class="type-var">_</span>, <span class="type-var">'extra</span> )</span> <a href="#type-with_extra">with_extra</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'extra</span></span></code></div><div class="spec-doc"><p><code>extra</code> allows you to expose extra information that was derived from the model. Note that for most components, <code>extra</code> has type <code>unit</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-on_display" class="anchored"><a href="#val-on_display" class="anchor"></a><code><span><span class="keyword">val</span> on_display : 
  <span><span><span>( <span class="type-var">'action</span>, <span class="type-var">_</span>, <span class="type-var">'state</span>, <span class="type-var">_</span> )</span> <a href="#type-with_extra">with_extra</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span>
  <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>on_display</code> is called every time the DOM is updated, with the model just before the update and the model just after the update. Use <code>on_display</code> to initiate actions.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?apply_action:
    <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?update_visibility:<span>( <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_display:<span>( <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../virtual_dom/Virtual_dom/Vdom/Node/index.html#type-t">Virtual_dom.Vdom.Node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'action</span>, <span class="type-var">'model</span>, <span class="type-var">'state</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Though this create function is not incremental, it is usually called in the context of an incremental computation function, like the one in <a href="../App_intf/module-type-S/index.html"><code>App_intf.S</code></a>. If some arguments are not supplied, defaults (which either return the model supplied or unit) are included in the component.</p><p>Note that the functions <code>apply_action</code>, <code>update_visibility</code> and <code>on_display</code> are allowed to perform effects, but the incremental computation that produces <code>create</code> should itself be functional.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create_with_extra" class="anchored"><a href="#val-create_with_extra" class="anchor"></a><code><span><span class="keyword">val</span> create_with_extra : 
  <span>?apply_action:
    <span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?update_visibility:<span>( <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'model</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_display:<span>( <span><span class="type-var">'state</span> <span class="arrow">&#45;&gt;</span></span> <span>schedule_action:<span>( <span><span class="type-var">'action</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>extra:<span class="type-var">'extra</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'model</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../virtual_dom/Virtual_dom/Vdom/Node/index.html#type-t">Virtual_dom.Vdom.Node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'action</span>, <span class="type-var">'model</span>, <span class="type-var">'state</span>, <span class="type-var">'extra</span> )</span> <a href="#type-with_extra">with_extra</a></span></span></code></div><div class="spec-doc"><p>Like <a href="#val-create"><code>create</code></a>, but allows for the specification of the <code>extra</code> parameter, which allows for component-specific state to be exposed.</p></div></div></div></body></html>