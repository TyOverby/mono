<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Node (incremental.Incremental.Expert.Node)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">incremental</a> &#x00BB; <a href="../../index.html">Incremental</a> &#x00BB; <a href="../index.html">Expert</a> &#x00BB; Node</nav><header class="odoc-preamble"><h1>Module <code><span>Expert.Node</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'w) t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_t" class="anchored"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="type-var">'w</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'w</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span><span class="type-var">'w</span> <a href="../../State/index.html#type-t">State.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?on_observability_change:<span>( <span>is_now_observable:bool <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'a</span>, <span class="type-var">'w</span> )</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>let t = create ?on_observability_change callback</code> creates a new expert node.</p><p><code>on_observability_change</code>, if given, is called whenever the node becomes observable or unobservable (with alternating value for <code>is_now_observable</code>, starting at <code>true</code> the first time the node becomes observable). This callback could run multiple times per stabilization. It should not change the incremental graph.</p><p><code>callback</code> is called if any dependency of <code>t</code> has changed since it was last called, or if the set of dependencies has changed. The callback will only run when all the dependencies are up-to-date, and inside the callback, you can safely call <code>Dependency.value</code> on your dependencies, as well as call all the functions below on the parent nodes. Any behavior that works on all incremental nodes (cutoff, invalidation, debug info etc) also work on <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-watch" class="anchored"><a href="#val-watch" class="anchor"></a><code><span><span class="keyword">val</span> watch : <span><span><span>( <span class="type-var">'a</span>, <span class="type-var">'w</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span class="type-var">'a</span>, <span class="type-var">'w</span> )</span> <a href="../../index.html#type-incremental">incremental</a></span></span></code></div><div class="spec-doc"><p><code>watch t</code> allows you to plug <code>t</code> in the rest of the incremental graph, but it's also useful to set a cutoff function, debug info etc.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-make_stale" class="anchored"><a href="#val-make_stale" class="anchor"></a><code><span><span class="keyword">val</span> make_stale : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Calling <code>make_stale t</code> ensures that incremental will recompute <code>t</code> before anyone reads its value. <code>t</code> may not fire though, if it never becomes necessary. This is intended to be called only from a child of <code>t</code>. Along with a well chosen cutoff function, it allows to choose which parents should fire.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-invalidate" class="anchored"><a href="#val-invalidate" class="anchor"></a><code><span><span class="keyword">val</span> invalidate : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">_</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>invalidate t</code> makes <code>t</code> invalid, as if its surrounding bind had changed. This is intended to be called only from a child of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_dependency" class="anchored"><a href="#val-add_dependency" class="anchor"></a><code><span><span class="keyword">val</span> add_dependency : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">'w</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">_</span>, <span class="type-var">'w</span> )</span> <a href="../Dependency/index.html#type-t">Dependency.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>add_dependency t dep</code> makes <code>t</code> depend on the child incremental in the <code>dep</code>. If <code>dep</code> is already used to link the child incremental to another parent, an exception is raised.</p><p>This is intended to be called either outside of stabilization, or right after creating <code>t</code>, or from a child of <code>t</code>.</p><p>The <code>on_change</code> callback of <code>dep</code> will be fired when <code>t</code> becomes observable, or immediately, or whenever the child changes as long as <code>t</code> is observable. When this function is called due to observability changes, the callback may fire several times in the same stabilization, so it should be idempotent. The callback must not change the incremental graph, particularly not the dependencies of <code>t</code>.</p><p>All the <code>on_change</code> callbacks are guaranteed to be run before the callback of <code>create</code> is run.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-remove_dependency" class="anchored"><a href="#val-remove_dependency" class="anchor"></a><code><span><span class="keyword">val</span> remove_dependency : <span><span><span>( <span class="type-var">_</span>, <span class="type-var">'w</span> )</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>( <span class="type-var">_</span>, <span class="type-var">'w</span> )</span> <a href="../Dependency/index.html#type-t">Dependency.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>remove_dependency t dep</code> can only be called from a child of <code>t</code>.</p></div></div></div></body></html>