<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Output (async.Log_extended.Output)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">async</a> &#x00BB; <a href="../index.html">Log_extended</a> &#x00BB; Output</nav><header class="odoc-preamble"><h1>Module <code><span>Log_extended.Output</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Format" class="anchored"><a href="#module-Format" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Format/index.html">Format</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?rotate:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../../async_kernel/Async_kernel/Deferred/index.html#type-t">Async_kernel.Deferred.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?close:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../../async_kernel/Async_kernel/Deferred/index.html#type-t">Async_kernel.Deferred.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>flush:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../../async_kernel/Async_kernel/Deferred/index.html#type-t">Async_kernel.Deferred.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span><a href="../Message/index.html#type-t">Message.t</a> <a href="../../../core/Core/Queue/index.html#type-t">Core.Queue.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../../async_kernel/Async_kernel/Deferred/index.html#type-t">Async_kernel.Deferred.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create f</code> returns a <code>t</code>, given a function that actually performs the final output work. It is the responsibility of the write function to contain all state, and to clean up after itself when it is garbage collected (which may require a finalizer). The function should avoid modifying the contents of the queue; it's reused for each <code>Output.t</code>.</p><p>The &quot;stock&quot; output modules support a sexp and bin_prot output format, and other output modules should make efforts to support them as well where it is meaningful/appropriate to do so.</p><p><code>flush</code> should return a deferred that is fulfilled only when all previously written messages are durable (e.g., on disk, out on the network, etc.). It is automatically called on shutdown by <code>Log</code>, but isn't automatically called at any other time. It can be called manually by calling <code>Log.flushed t</code>.</p><p>The <code>unit Deferred</code> returned by the function provides an opportunity for pushback if that is important. Only one batch of messages will be &quot;in flight&quot; at any time based on this deferred.</p><p>An optional <code>rotate</code> function may be given which will be called when <code>Log.rotate t</code> is called while this output is in effect. This is useful for programs that want very precise control over rotation.</p><p>If <code>close</code> is provided it will be called when the log falls out of scope. (Note that it is not called directly, even if you close a log which is using this output, because outputs are sometimes reused.)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-stdout" class="anchored"><a href="#val-stdout" class="anchor"></a><code><span><span class="keyword">val</span> stdout : <span>?format:<a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>stdout</code> defaults to <code>format=`Text</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-stderr" class="anchored"><a href="#val-stderr" class="anchor"></a><code><span><span class="keyword">val</span> stderr : <span>?format:<a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>stderr</code> defaults to <code>format=`Text</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-writer" class="anchored"><a href="#val-writer" class="anchor"></a><code><span><span class="keyword">val</span> writer : <span><a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../async_unix/Async_unix/Writer/index.html#type-t">Async_unix.Writer.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-file" class="anchored"><a href="#val-file" class="anchor"></a><code><span><span class="keyword">val</span> file : <span>?perm:<a href="../../../core_unix/Core_unix/index.html#type-file_perm">Core_unix.file_perm</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span> <span>filename:string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>The <code>perm</code> argument is passed through to <code>Writer.open_file</code>, and so has the default behavior described there.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-rotating_file" class="anchored"><a href="#val-rotating_file" class="anchor"></a><code><span><span class="keyword">val</span> rotating_file : 
  <span>?perm:<a href="../../../core_unix/Core_unix/index.html#type-file_perm">Core_unix.file_perm</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?time_source:<a href="../../../async_kernel/Async_kernel/Synchronous_time_source/index.html#type-t">Async_kernel.Synchronous_time_source.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?log_on_rotation:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="../Message/index.html#type-t">Message.t</a> list</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>basename:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Rotation/index.html#type-t">Rotation.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-rotating_file_with_tail" class="anchored"><a href="#val-rotating_file_with_tail" class="anchor"></a><code><span><span class="keyword">val</span> rotating_file_with_tail : 
  <span>?perm:<a href="../../../core_unix/Core_unix/index.html#type-file_perm">Core_unix.file_perm</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?time_source:<a href="../../../async_kernel/Async_kernel/Synchronous_time_source/index.html#type-t">Async_kernel.Synchronous_time_source.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?log_on_rotation:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="../Message/index.html#type-t">Message.t</a> list</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Format/index.html#type-t">Format.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>basename:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Rotation/index.html#type-t">Rotation.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a> * <span>string <a href="../../../async_kernel/Async_kernel/Tail/index.html#type-t">Async_kernel.Tail.t</a></span></span></code></div><div class="spec-doc"><p>Returns a tail of the filenames. When <code>rotate</code> is called, the previous filename is put on the tail</p></div></div><div class="odoc-spec"><div class="spec value" id="val-filter_to_level" class="anchored"><a href="#val-filter_to_level" class="anchor"></a><code><span><span class="keyword">val</span> filter_to_level : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>level:<a href="../Level/index.html#type-t">Level.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>filter_to_level</code> wraps an output and gives you a new output which only logs messages which are as/more verbose than <code>level</code>.</p><p>This functionality is intended for when you have multiple outputs being displayed in different places, and they need to be at different levels.</p><p>If you have one output (or multiple outputs all at the same level), it is better to set the <code>Log.t</code>'s output directly with <code>set_level</code>, which is equivalent and more efficient.</p></div></div><p>See <a href="../index.html"><code>Log_extended</code></a> for syslog and colorized console output.</p></div></body></html>