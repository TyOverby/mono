<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Squeue (core_unix.Squeue)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">core_unix</a> &#x00BB; Squeue</nav><header class="odoc-preamble"><h1>Module <code><span>Squeue</span></code></h1><p>Thread-safe queue module, using locks.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_t" class="anchored"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>create maxsize</code> returns a synchronized queue bounded to have no more than <code>maxsize</code> elements.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-push" class="anchored"><a href="#val-push" class="anchor"></a><code><span><span class="keyword">val</span> push : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Blocks until there's room on the queue, then pushes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-push_uncond" class="anchored"><a href="#val-push_uncond" class="anchor"></a><code><span><span class="keyword">val</span> push_uncond : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Does not block, may grow the queue past maxsize.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-push_or_drop" class="anchored"><a href="#val-push_or_drop" class="anchor"></a><code><span><span class="keyword">val</span> push_or_drop : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Pushes an event on the queue if the queue is less than maxsize, otherwise drops it. Returns true if the push was successful</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length" class="anchored"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Returns the number of elements in the queue.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pop" class="anchored"><a href="#val-pop" class="anchor"></a><code><span><span class="keyword">val</span> pop : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Pops an element off the queue, blocking until something is available</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lpop" class="anchored"><a href="#val-lpop" class="anchor"></a><code><span><span class="keyword">val</span> lpop : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> * int</span></code></div><div class="spec-doc"><p>Returns the element popped and the length of the queue this element was popped.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transfer_queue_in" class="anchored"><a href="#val-transfer_queue_in" class="anchor"></a><code><span><span class="keyword">val</span> transfer_queue_in : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../core/Core/Linked_queue/index.html#type-t">Core.Linked_queue.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Transfers all the elements from an ordinary queue into the squeue. Blocks until there's room on the queue, then pushes. May grow queue past maxsize.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transfer_queue_in_uncond" class="anchored"><a href="#val-transfer_queue_in_uncond" class="anchor"></a><code><span><span class="keyword">val</span> transfer_queue_in_uncond : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../core/Core/Linked_queue/index.html#type-t">Core.Linked_queue.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-transfer_queue" class="anchored"><a href="#val-transfer_queue" class="anchor"></a><code><span><span class="keyword">val</span> transfer_queue : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../core/Core/Linked_queue/index.html#type-t">Core.Linked_queue.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Transfers all elements from the squeue to an ordinary queue. The elements remain in order. Waits until at least one element can be transferred.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transfer_queue_nowait" class="anchored"><a href="#val-transfer_queue_nowait" class="anchor"></a><code><span><span class="keyword">val</span> transfer_queue_nowait : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../core/Core/Linked_queue/index.html#type-t">Core.Linked_queue.t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Transfers all elements from the squeue to an ordinary queue. The elements remain in order. Does not wait for elements to arrive.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-clear" class="anchored"><a href="#val-clear" class="anchor"></a><code><span><span class="keyword">val</span> clear : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Clears the queue</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait_not_empty" class="anchored"><a href="#val-wait_not_empty" class="anchor"></a><code><span><span class="keyword">val</span> wait_not_empty : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>wait_not_empty sq</code> waits for something to be available. This is useful if you want to wait, but not take something out. This function is not useful in most cases, but in some complex cases it is essential. For example, if you need to take another lock before you remove something from the queue for processing, you might want to try to take that other lock, and if it fails do something else.</p><p>This function is not dangerous, there is just <em>one</em> thing you <em>have</em> to remember if you use it: Just because this function returns doesn't mean that <code>pop</code> will succeed; someone might have gotten there first, so you have to use <code>transfer_queue_nowait</code> if you don't want to block.</p></div></div></div></body></html>